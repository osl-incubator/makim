version: 1.0
working-directory: "/tmp"

groups:
  setup:
    tasks:
      folders:
        help: Create necessary folders
        run: |
          mkdir -p /tmp/group1
          mkdir -p /tmp/group1/target3
          mkdir -p /tmp/group2
          mkdir -p /tmp/group2/task-relative
          mkdir -p /tmp/group1/target4

  group-no-path:
    tasks:
      task-no-path:
        help: Test global absolute path, group no path, task no path
        dependencies:
          - task: setup.folders
        run: |
          import os
          print(os.getcwd())
          assert os.getcwd() == "/tmp"
          echo "working-directory-absolute-path [I] Done!"

      task-absolute:
        working-directory: "/tmp"
        help: Test global absolute path, group no path, task absolute path
        dependencies:
          - task: setup.folders
        run: |
          import os
          assert os.getcwd() == "/tmp"
          echo "working-directory-absolute-path [II] Done!"

      task-relative:
        working-directory: "/tmp/group1/target4"
        help: est global absolute path, group no path, task relative path
        dependencies:
          - task: setup.folders
        run: |
          import os
          assert os.getcwd() == "/tmp/group1/target4"
          echo "working-directory-absolute-path [III] Done!"

  group-relative:
    working-directory: "group1"
    tasks:
      task-no-path:
        help: Test global absolute path, group relative path, task no path
        dependencies:
          - task: setup.folders
        run: |
          import os
          assert os.getcwd() == "/tmp/group1"
          echo "working-directory-absolute-path [IV] Done!"

      task-absolute:
        working-directory: "/tmp"
        help: Test global absolute path, group relative path, task absolute path
        dependencies:
          - task: setup.folders
        run: |
          import os
          assert os.getcwd() == "/tmp"
          echo "working-directory-absolute-path [V] Done!"

      task-relative:
        working-directory: "target3"
        help: Test global absolute path, group relative path, task relative path
        dependencies:
          - task: setup.folders
        run: |
          import os
          assert os.getcwd() == "/tmp/group1/target3"
          echo "working-directory-absolute-path [VI] Done!"

  group-absolute:
    working-directory: "/tmp/group2"
    tasks:
      task-no-path:
        help: Test global absolute path, group absolute path, task no path
        dependencies:
          - task: setup.folders
        run: |
          import os
          assert os.getcwd() == "/tmp/group2"
          echo "working-directory-absolute-path [VII] Done!"

      task-absolute:
        working-directory: "/tmp"
        help: Test global absolute path, group absolute path, task absolute path
        dependencies:
          - task: setup.folders
        run: |
          import os
          assert os.getcwd() == "/tmp"
          echo "working-directory-absolute-path [VIII] Done!"

      task-relative:
        working-directory: "task-relative"
        help: |
          Test global absolute path, group absolute path, task relative  path
        dependencies:
          - task: setup.folders
        run: |
          import os
          assert os.getcwd() == "/tmp/group2/task-relative"
          echo "working-directory-absolute-path [IX] Done!"
