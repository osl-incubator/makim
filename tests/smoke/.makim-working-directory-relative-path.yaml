version: 1.0
working-directory: "global-relative"

groups:
  setup:
    tasks:
      create-folders:
        run: |
          mkdir -p /tmp/global-relative
          mkdir -p /tmp/global-relative/target1
          mkdir -p /tmp/global-relative/target2
          mkdir -p /tmp/global-relative/group-absolute/target1
          mkdir -p /tmp/global-relative/group-relative/target1

  group-no-path:
    tasks:
      task-no-path:
        help: Test global relative path, group no-path, task no-path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          print(os.getcwd())
          assert os.getcwd() == "/tmp/global-relative"
          echo "working-directory-relative-path [I] Done!"

      task-absolute:
        working-directory: "/tmp/global-relative/target1"
        help: Test global relative path, group no-path, task absolute path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/global-relative/target1"
          echo "working-directory-relative-path [II] Done!"

      task-relative:
        working-directory: "target2"
        help: Test global relative path, group no-path, task relative path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/global-relative/target2"
          echo "working-directory-relative-path [III] Done!"

  group-absolute:
    working-directory: "/tmp/global-relative/group-absolute"
    tasks:
      task-no-path:
        help: Test global relative path, group absolute path, task no-path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/global-relative/group-absolute"
          echo "working-directory-relative-path [IV] Done!"

      task-absolute:
        working-directory: "/tmp/global-relative/target2"
        help: |
          Test global relative path, group absolute path, task absolute path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/global-relative/target2"
          echo "working-directory-relative-path [V] Done!"

      task-relative:
        working-directory: "target1"
        help: |
          Test global relative path, group absolute path, task relative path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/global-relative/group-absolute/target1"
          echo "working-directory-relative-path [VI] Done!"

  group-relative:
    working-directory: "group-relative"
    tasks:
      task-no-path:
        help: Test global relative path, group relative path, task no-path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/global-relative/group-relative"
          echo "working-directory-relative-path [VII] Done!"

      task-absolute:
        working-directory: "/tmp/global-relative/target2"
        help: |
          Test global relative path, group absolute path, task absolute path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/global-relative/target2"
          echo "working-directory-relative-path [VIII] Done!"

      task-relative:
        working-directory: "target1"
        help: |
          Test global relative path, group absolute path, task relative path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/global-relative/group-relative/target1"
          echo "working-directory-relative-path [IX] Done!"
